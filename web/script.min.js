function id(e){return document.getElementById(e)}function get(e){return localStorage[e]}function set(e,t){localStorage[e]=t}function generateNotation(){switch(get("cube")){case"3x3":n=["U","D","F","B","L","R"],a=["i","i","i","2","2","","","","","","",""];break;case"Pyraminx":n=["U","B","L","R"],a=["i","i","","",""];break;case"4x4":case"5x5":n=["U","D","F","B","L","R","Fw","Bw","Rw","Lw","Uw","Bw"],a=["'","'","'","2","2","","","","","","",""];break;case"Skewb":n=["U","B","L","R"],a=["i","i","","",""];break;default:n=["U","D","F","B","L","R"],a=["i","i","i","2","2","","","","","","",""]}return n[Math.floor(n.length*Math.random())]+a[Math.floor(a.length*Math.random())]}function generateScramble(){for(scramble="",notation="U",notation2="",scrambleLengths.Pyraminx=Math.round(Math.max(12*Math.random(),8)),scrambleLengths.Skewb=Math.round(Math.max(9*Math.random(),6)),i=0;i<scrambleLengths[get("cube")];i++){for(notation2=notation,notation=generateNotation();notation.charAt(0)==notation2.charAt(0)||Math.floor(n.indexOf(notation.charAt(0))/2)==Math.floor(n.indexOf(notation2.charAt(0))/2)||notation2.charAt(0)==notation.charAt(0);)notation=generateNotation();scramble+=notation+" "}return scramble}function updateTimes(){id("times").innerHTML="";try{if(get(get("cube")+"Times").includes("|")){var e=get(get("cube")+"Times").split("|");if(e.length>0)for(i=0;i<e.length;i++)if(""!=e[i]){var t=Math.floor(i/cpr),r=i%cpr;0==r&&(table["row"+t]=id("times").insertRow(-1)),table["row"+t]["cell"+r]=table["row"+t].insertCell(-1),table["row"+t]["cell"+r].innerHTML=e[i]}id("timesCollapse").style.visibility="",id("timesCollapse").previousElementSibling.style.visibility="",id("timesCollapse").nextElementSibling.style.visibility=""}else id("timesCollapse").style.visibility="hidden",id("timesCollapse").previousElementSibling.style.visibility="hidden",id("timesCollapse").nextElementSibling.style.visibility="hidden"}catch(e){try{var n=get(get("cube")+"Times").split("|");n.pop(),set(get("cube")+"Cells",n.length)}catch(e){}}}function orientation(){cpr=Math.floor(window.innerWidth/100)-1,(navigator.userAgent.match(/iPhone|iPad|iPod/i)||navigator.userAgent.match(/Android/i))&&(cpr=Math.min(Math.floor(screen.width/100),12)),(!cpr||cpr<=0)&&(cpr=1),updateTimes()}function refreshStats(){var e=get(get("cube")+"Times").split("|");if(e.pop(),e.length>1){var t=[];for(i=0;i<e.length;i++){var r=e[i].split(":");3==r.length?t[i]=6e4*+r[0]+1e3*+r[1]+ +r[2]:t[i]=1e3*+r[0]+ +r[1]}var n=t.reduce(function(e,t){return e+t}),o=n/t.length;id("stats").innerHTML="<tr><td>"+timer.format(Array.min(t))+"</td><td>"+timer.format(Math.round(o))+"</td><td>"+timer.format(Array.max(t))+"</td></tr>"}else id("stats").innerHTML=""}function collapseTimes(){set("timesVisible",!timesVisible),timesVisible="true"==get("timesVisible"),id("times").style.visibility=timesVisible?"visible":"hidden",id("timesCollapse").innerHTML=timesVisible?"Hide times":"Show times"}function updateCollapse(){id("times").style.visibility=timesVisible?"visible":"hidden",id("timesCollapse").innerHTML=timesVisible?"Hide times":"Show times"}function updateCube(){set("cube",id("cube").value),updateTimes(),refreshStats(),id("scramble").innerHTML=generateScramble()}Array.min=function(e){return Math.min.apply(Math,e)},Array.max=function(e){return Math.max.apply(Math,e)};var timer={time:0,run:"false",base:0},table={},cpr=Math.floor(window.innerWidth/100)-1;set("cube",get("cube")||"3x3"),set("3x3Cells",get("3x3Cells")||0),set("2x2Cells",get("2x2Cells")||0),set("4x4Cells",get("4x4Cells")||0),set("5x5Cells",get("5x5Cells")||0),set("SkewbCells",get("SkewbCells")||0),set("PyraminxCells",get("PyraminxCells")||0),(navigator.userAgent.match(/iPhone|iPad|iPod/i)||navigator.userAgent.match(/Android/i))&&(cpr=Math.min(Math.floor(screen.width/100),12)),(!cpr||cpr<=0)&&(cpr=1),set("3x3Times",get("3x3Times")||""),set("2x2Times",get("2x2Times")||""),set("4x4Times",get("4x4Times")||""),set("5x5Times",get("5x5Times")||""),set("SkewbTimes",get("SkewbTimes")||""),set("PyraminxTimes",get("PyraminxTimes")||""),timer.toggle=function(){if("false"==timer.run){if("rgb(127, 255, 0)"==id("timer").style.color){timer.time=0,timer.base=new Date,timer.run="true",id("timer").style.color="#7FFF00",document.body.style.background="#000";var e=document.querySelectorAll("body *:not(#timer):not(main):not(strong)");for(i=0;i<e.length;i++)e[i].style.visibility="hidden"}}else if("true"==timer.run){timer.run="false",id("timer").style.color="#FFF",id("scramble").innerHTML=generateScramble();try{var t=Math.floor(get(get("cube")+"Cells")/cpr),r=get(get("cube")+"Cells")%cpr;0===r&&(table["row"+t]=id("times").insertRow(-1)),table["row"+t]["cell"+r]=table["row"+t].insertCell(-1),set(get("cube")+"Times",get(get("cube")+"Times")+timer.format(timer.time)+"|"),table["row"+t]["cell"+r].innerHTML=timer.format(timer.time),set(get("cube")+"Cells",parseFloat(get(get("cube")+"Cells"))+1);var n=get(get("cube")+"Times").split("|");for(n.pop(),i=0;i<n.length;i++)for(j=0;n[i].includes(":");j++)n[i]=n[i].replace(":","")}catch(e){try{var n=get(get("cube")+"Times").split("|");n.pop(),set(get(get("cube")+"Cells"),n.length)}catch(e){}}if(timer.time==Array.min(n)){document.body.style.background="#64DD17";try{window.navigator.vibrate(200)}catch(e){}}refreshStats();var e=document.querySelectorAll("body *:not(#timer):not(#times)");for(i=0;i<e.length;i++)e[i].style.visibility="";updateCollapse()}},timer.tick=function(){"true"==timer.run&&(timer.time=new Date-timer.base,id("timer").innerHTML=timer.format(timer.time),id("timer").style.fontSize=100-17*(id("timer").innerHTML.length-6)+"px"),window.requestAnimationFrame(timer.tick)},timer.format=function(e){var t=e.toString().substring(e.toString().length-3,e.toString().length),r=Math.floor(e/36e5),n=Math.floor(e/6e4)-60*r,o=Math.floor(e/1e3)-60*n;for(r>0&&(o-=60*n),e="",r>=1&&(e=r+":"),n>=1&&(e+=n+":"),i=0;i<2-o.toString().length;i++)o="0"+o;for(e+=o+":",i=0;i<3-t.length;i++)t="0"+t;return e+=t};var scrambleLengths={},a,n;scrambleLengths["3x3"]=25,scrambleLengths["2x2"]=9,scrambleLengths["4x4"]=40,scrambleLengths["5x5"]=60,scrambleLengths.Skewb=Math.round(Math.max(9*Math.random(),6)),scrambleLengths.Pyraminx=Math.round(Math.max(12*Math.random(),8));var keyDown="false",timeout;document.body.onkeyup=function(e){timer.toggle(),id("timer").style.color="#FFF",keyDown="false"},document.body.onkeydown=function(e){"false"==keyDown&&("false"==timer.run?(document.body.style.background="#000",id("timer").style.color="#F00",clearTimeout(timeout),timeout=setTimeout(function(){"true"==keyDown&&(id("timer").style.color="#7FFF00")},500)):(timer.toggle(),id("timer").style.color="#FFF"),keyDown="true")},navigator.userAgent.match(/iPhone|iPad|iPod/i)||navigator.userAgent.match(/Android/i)?(id("timesCollapse").ontouchend=collapseTimes,id("scramble").ontouchstart=function(){id("scramble").innerHTML=generateScramble()}):(document.body.onmouseup=function(e){timer.toggle(),id("timer").style.color="#FFF",keyDown="false"},id("timer").onmousedown=function(e){"false"==keyDown&&("false"==timer.run?(document.body.style.background="#000",id("timer").style.color="#F00",clearTimeout(timeout),timeout=setTimeout(function(){"true"==keyDown&&(id("timer").style.color="#7FFF00")},500)):(timer.toggle(),id("timer").style.color="#FFF"),keyDown="true")},id("scramble").onmousedown=function(){id("scramble").innerHTML=generateScramble()},id("timesCollapse").onmouseup=collapseTimes,id("timesCollapse").setAttribute("class","hover"),id("times").setAttribute("class","hover"),id("scramble").setAttribute("class","hover")),document.body.ontouchend=function(e){"timer"==e.target.id&&(timer.toggle(),id("timer").style.color="#FFFFFF"),keyDown="false"},document.body.ontouchstart=function(e){"false"==keyDown&&("false"==timer.run&&"timer"==e.target.id?(document.body.style.background="#000",id("timer").style.color="#F00",clearTimeout(timeout),timeout=setTimeout(function(){"true"==keyDown&&(id("timer").style.color="#7FFF00",window.navigator.vibrate(50))},500)):"true"==timer.run&&(timer.toggle(),id("timer").style.color="#FFF"),keyDown="true")},id("times").onclick=function(e){"false"==timer.run&&(set(get("cube")+"Times",get(get("cube")+"Times").replace(e.target.innerHTML+"|","")),set(get("cube")+"Cells",parseFloat(get(get("cube")+"Cells"))-1),updateTimes(),refreshStats())},document.body.oncontextmenu=function(e){e.preventDefault()},updateTimes(),id("scramble").innerHTML=generateScramble(),void 0==get("timesVisible")&&set("timesVisible",!0);var timesVisible="true"==get("timesVisible");id("cube").value=get("cube"),updateCollapse(),refreshStats(),window.addEventListener("orientationchange",orientation),window.addEventListener("resize",orientation),timer.tick();